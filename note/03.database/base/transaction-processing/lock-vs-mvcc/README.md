# 锁与MVCC的关系

## 目的不同但相辅相成
- **MVCC**：主要通过维护数据的多个版本来实现并发控制，旨在提高数据库的并发性能，允许读写操作同时进行，减少锁竞争。
- **锁**：通过锁定数据资源来避免并发操作中的冲突，保证数据的一致性和完整性。锁机制包括悲观锁和乐观锁，悲观锁在数据处理前加锁，乐观锁则通过版本号或时间戳等方式在数据处理过程中检查冲突。

## 实现方式不同
- **MVCC**：在`InnoDB`等存储引擎中，MVCC通过维护数据的多个版本来实现。当事务对数据进行修改时，旧的数据版本会被保存在Undo日志中，同时为新的事务生成新的数据版本。这样，不同的事务可以根据需要读取不同版本的数据，从而实现非阻塞的并发访问。
- **锁**：则通过直接锁定数据资源来避免冲突。悲观锁在数据处理前加锁，阻止其他事务对同一资源的访问；乐观锁则在数据处理过程中通过版本号或时间戳等方式来检查是否存在冲突。

## 应用场景不同
- **MVCC**：更适用于读多写少的场景，因为它能够显著提高数据库的并发性能，减少锁竞争。
- **锁**：则适用于写操作较多的场景，因为它能够直接锁定资源，防止数据在并发修改时出现冲突。