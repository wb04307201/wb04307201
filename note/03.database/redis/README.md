# Redis

Redis （REmote DIctionary Server）是一个基于 C 语言开发的开源 NoSQL 数据库（BSD 许可）。

## Redis 为什么快？
- Redis 基于内存，内存的访问速度比磁盘快很多；
- Redis 基于 Reactor 模式设计开发了一套高效的事件处理模型，主要是单线程事件循环和 IO 多路复用（Redis 线程模式后面会详细介绍到）；
- Redis 内置了多种优化过后的数据类型/结构实现，性能非常高。
- Redis 通信协议实现简单且解析高效。

![img.png](img.png)

## 缓存选型

### 内存缓存
- **HashMap**：HashMap是Java中最常用的内存缓存实现之一。它使用哈希表数据结构来存储键值对，具有快速的查找和插入操作。
- **ConcurrentHashMap**：ConcurrentHashMap是线程安全的HashMap实现，适用于多线程环境下的缓存需求。它使用分段锁来实现并发访问，提供了更高的并发性能。
- **Caffeine**：Caffeine是一个基于Java的高性能缓存库，提供了内存缓存的功能。它使用了类似于ConcurrentHashMap的分段锁机制，并提供了更多的缓存策略和配置选项。
- **Guava Cache**：Guava Cache是Google Guava库中提供的一个内存缓存实现。它提供了简单易用的API，并支持缓存的过期时间、最大大小等配置选项。
- **Ehcache**：Ehcache是一个流行的Java缓存框架，支持内存缓存和磁盘缓存。它提供了丰富的配置选项和缓存策略，适用于各种缓存需求。

### 分布式缓存
- **Redis**：Redis是一种开源的内存数据存储系统，也可以用作分布式缓存。它支持多种数据结构（如字符串、哈希、列表、集合、有序集合等），并提供了丰富的缓存功能和命令。
- **Memcached**：Memcached是一种高性能的分布式内存对象缓存系统。它以键值对的形式存储数据，并提供了简单的API来进行数据的读取和写入。Memcached可以水平扩展，适用于大规模的分布式缓存需求。
- **Hazelcast**：Hazelcast是一个开源的分布式缓存和计算平台。它提供了分布式数据结构（如Map、Queue、Set等），支持高可用性和水平扩展，并提供了分布式缓存的功能。
- **Apache Ignite**：Apache Ignite是一个内存中的分布式数据库和计算平台。它提供了分布式缓存、分布式查询、分布式计算等功能，并支持持久化存储和高可用性。
- **Caffeine**：虽然Caffeine在前面提到的是内存缓存，但它也可以用作分布式缓存。Caffeine提供了一些分布式缓存的扩展，如Caffeine-JCache和Caffeine-Rest。
- **Dragonfly**：一种针对现代应用程序负荷需求而构建的内存数据库，完全兼容 Redis 和 Memcached 的 API，迁移时无需修改任何代码，号称全世界最快的内存数据库。
- **KeyDB**：Redis 的一个高性能分支，专注于多线程、内存效率和高吞吐量。

### Ehcache、Caffeine、Memcached和Redis优缺点以及适用场景
1. Ehcache
  - **优点**：
    - 支持本地缓存和分布式缓存。
    - 提供了丰富的配置选项和缓存策略，如过期时间、最大大小、持久化等。
    - 可以与Spring框架无缝集成。
  - **缺点**：
    - 在高并发环境下，性能可能不如Caffeine、Memcached和Redis。
    - 分布式缓存功能相对较新，可能不如Redis和Memcached成熟稳定。
  - **适用场景**：  
    - 需要本地缓存和分布式缓存的场景。  
    - 对缓存的配置和策略有较高要求的场景。

2. Caffeine
- **优点**：
  - 提供了高性能的本地缓存实现。
    - 支持多种缓存策略，如最大大小、过期时间、自动加载等。
    - 可以根据应用程序的需求进行灵活的配置。
- **缺点**：
  - 不支持分布式缓存，只能用作本地缓存。
    - 不支持持久化存储。
- **适用场景**：
  - 需要高性能的本地缓存的场景。
    - 对缓存的灵活配置和策略有较高要求的场景。
    - 
3. Memcached
- **优点**：
  - 提供了高性能的分布式缓存实现。
  - 支持多种数据结构和缓存策略。
  - 可以水平扩展，适用于大规模的分布式缓存需求。
- **缺点**：
  - 不支持持久化存储。
  - 功能相对较简单，不如Redis丰富。
- **适用场景**：
  - 需要高性能的分布式缓存的场景。
  - 对缓存的扩展性和可伸缩性有较高要求的场景。

4. Redis
- **优点**：
  - 提供了高性能的分布式缓存和数据存储。
  - 支持多种数据结构和缓存策略。
  - 支持持久化存储和数据复制。
  - 提供了丰富的功能，如发布/订阅、事务等。
- **缺点**：
  - 相对于本地缓存实现，性能可能稍低。
- **适用场景**：
  - 需要高性能的分布式缓存和数据存储的场景。
  - 对缓存的持久化和数据复制有较高要求的场景。
  - 需要使用缓存以外的功能，如发布/订阅、事务等的场景。

### Memcached 和 Redis 比较
#### 共同点
- 都是基于内存的数据库，一般都用来当做缓存使用。
- 都有过期策略。
- 两者的性能都非常高。
#### 区别
- **数据类型**：Redis 支持更丰富的数据类型（支持更复杂的应用场景）。Redis 不仅仅支持简单的 k/v 类型的数据，同时还提供 list，set，zset，hash 等数据结构的存储。Memcached 只支持最简单的 k/v 数据类型。
- **数据持久化**：Redis 支持数据的持久化，可以将内存中的数据保持在磁盘中，重启的时候可以再次加载进行使用，而 Memcached 把数据全部存在内存之中。也就是说，Redis 有灾难恢复机制而 Memcached 没有。
- **集群模式支持**：Memcached 没有原生的集群模式，需要依靠客户端来实现往集群中分片写入数据；但是 Redis 自 3.0 版本起是原生支持集群模式的。
- **线程模型**：Memcached 是多线程，非阻塞 IO 复用的网络模型；Redis 使用单线程的多路 IO 复用模型。 （Redis 6.0 针对网络数据的读写引入了多线程）
- **特性支持**：Redis 支持发布订阅模型、Lua 脚本、事务等功能，而 Memcached 不支持。并且，Redis 支持更多的编程语言。
- **过期数据删除**：Memcached 过期数据的删除策略只用了惰性删除，而 Redis 同时使用了惰性删除与定期删除
#### 为选择 Redis
- 访问速度更快
- 高并发
- 功能全面
- 生态全面
- 支持持久化（很重要的一点）

## Redis Module
Redis 从 4.0 版本开始，支持通过 Module 来扩展其功能以满足特殊的需求。
- **RediSearch**：用于实现搜索引擎的模块。
- **RedisJSON**：用于处理 JSON 数据的模块。
- **RedisGraph**：用于实现图形数据库的模块。
- **RedisTimeSeries**：用于处理时间序列数据的模块。
- **RedisBloom**：用于实现布隆过滤器的模块。
- **RedisAI**：用于执行深度学习/机器学习模型并管理其数据的模块。
- **RedisCell**：用于实现分布式限流的模块。
- ……

## Redis 数据类型和应用场景

- **5 种基础数据类型**：String（字符串）、List（列表）、Set（集合）、Hash（散列）、Zset（有序集合）。
- **3 种特殊数据类型**：HyperLogLog（基数统计）、Bitmap （位图）、Geospatial (地理位置)。

