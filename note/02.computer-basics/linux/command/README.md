# Linux å‘½ä»¤

ä»¥ä¸‹æ˜¯åœ¨ Linux æœåŠ¡å™¨ç®¡ç†ä¸­**æœ€å¸¸ç”¨ä¸”å…³é”®**çš„å‘½ä»¤åˆ†ç±»æ•´ç†ï¼Œé™„å¸¦æ ¸å¿ƒç”¨æ³•è¯´æ˜å’Œå…¸å‹åœºæ™¯ç¤ºä¾‹ï¼š

---

### **ä¸€ã€ç³»ç»Ÿä¿¡æ¯ & èµ„æºç›‘æ§**
| å‘½ä»¤          | ä½œç”¨                          | å…¸å‹ç”¨æ³•ç¤ºä¾‹                     |
|---------------|-----------------------------|--------------------------------|
| `top` / `htop` | **å®æ—¶è¿›ç¨‹ç›‘æ§** (htop æ›´å‹å¥½) | `htop` (éœ€å®‰è£…ï¼š`apt install htop`) |
| `free -h`     | æŸ¥çœ‹å†…å­˜ä½¿ç”¨ (äººç±»å¯è¯»æ ¼å¼)     | `free -h` â†’ æ˜¾ç¤º RAM/swap ç”¨é‡    |
| `df -h`       | **ç£ç›˜ç©ºé—´**ä½¿ç”¨æƒ…å†µ          | `df -h /` â†’ æŸ¥çœ‹æ ¹åˆ†åŒºå‰©ä½™ç©ºé—´     |
| `du -sh /path`| ç›®å½•å ç”¨ç©ºé—´å¤§å°              | `du -sh /var/log` â†’ æŸ¥æ—¥å¿—ç›®å½•å¤§å° |
| `uptime`      | ç³»ç»Ÿè¿è¡Œæ—¶é—´ + å¹³å‡è´Ÿè½½        | `uptime` â†’ æ˜¾ç¤º 1/5/15 åˆ†é’Ÿè´Ÿè½½   |
| `vmstat 2`    | è™šæ‹Ÿå†…å­˜ç»Ÿè®¡ (æ¯2ç§’åˆ·æ–°)       | `vmstat 2` â†’ ç›‘æ§ CPU/å†…å­˜/IO ç“¶é¢ˆ |
| `iostat -x 2` | **ç£ç›˜ I/O æ€§èƒ½**åˆ†æ         | `iostat -x 2` â†’ å®šä½æ…¢ç£ç›˜é—®é¢˜     |

---

### **äºŒã€æ–‡ä»¶ & ç›®å½•æ“ä½œ**
| å‘½ä»¤                     | ä½œç”¨                          | é«˜é¢‘åœºæ™¯ç¤ºä¾‹                     |
|--------------------------|-----------------------------|--------------------------------|
| `ls -lhtr`               | äººæ€§åŒ–åˆ—å‡ºæ–‡ä»¶ (æŒ‰æ—¶é—´æ’åº)    | `ls -lhtr /backup` â†’ æŸ¥çœ‹æœ€æ–°å¤‡ä»½ |
| `grep "error" /var/log/syslog` | **æ–‡æœ¬æœç´¢** (æ—¥å¿—åˆ†æå¿…å¤‡)   | `grep -i "fail" auth.log` â†’ å¿½ç•¥å¤§å°å†™æœç´¢ |
| `find / -name "*.log" -mtime +7` | æŒ‰æ¡ä»¶**æŸ¥æ‰¾æ–‡ä»¶**          | `find /tmp -size +100M` â†’ æ‰¾å¤§æ–‡ä»¶ |
| `tar -czvf backup.tar.gz /data` | **å‹ç¼©/è§£å‹** (å¸¸ç”¨)       | `tar -xzvf file.tar.gz` â†’ è§£å‹    |
| `rsync -avz /src user@host:/dest` | **å®‰å…¨åŒæ­¥æ–‡ä»¶** (æ›¿ä»£ scp) | `rsync -avz --delete /data/ remote:/backup/` â†’ å¢é‡åŒæ­¥+åˆ é™¤å¤šä½™æ–‡ä»¶ |
| `scp file user@host:/path` | å®‰å…¨æ‹·è´æ–‡ä»¶ (è·¨æœåŠ¡å™¨)       | `scp -P 2222 db.sql user@192.168.1.10:/backup` â†’ æŒ‡å®šç«¯å£ä¼ è¾“ |

---

### **ä¸‰ã€è¿›ç¨‹ç®¡ç†**
| å‘½ä»¤                          | ä½œç”¨                     | å…³é”®æŠ€å·§                          |
|-------------------------------|------------------------|---------------------------------|
| `ps aux \| grep nginx`        | **æŸ¥çœ‹è¿›ç¨‹**            | `ps -ef \| grep java` â†’ æŸ¥ Java æœåŠ¡ |
| `kill -9 <PID>`               | å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹            | `killall nginx` â†’ æŒ‰åç§°æ€è¿›ç¨‹      |
| `systemctl start nginx`       | **ç®¡ç†æœåŠ¡** (systemd)  | `systemctl status sshd` â†’ æŸ¥æœåŠ¡çŠ¶æ€ |
| `journalctl -u nginx -f`      | å®æ—¶æŸ¥çœ‹æœåŠ¡æ—¥å¿—        | `journalctl --since "2025-01-01"` â†’ æŒ‰æ—¶é—´è¿‡æ»¤ |
| `nohup ./script.sh &`         | åå°è¿è¡Œä»»åŠ¡ (é˜²æ–­è¿)    | `nohup python app.py > log.out 2>&1 &` â†’ é‡å®šå‘è¾“å‡º |

---

### **å››ã€ç½‘ç»œè¯Šæ–­**
| å‘½ä»¤                          | ä½œç”¨                     | å®æˆ˜åœºæ™¯                          |
|-------------------------------|------------------------|---------------------------------|
| `ss -tulpn`                   | **æ›¿ä»£ netstat** (æ›´å¿«) | `ss -ltn` â†’ æŸ¥ç›‘å¬ç«¯å£ (TCP)       |
| `ping 8.8.8.8`                | æµ‹è¯•ç½‘ç»œè¿é€šæ€§          | `ping -c 4 baidu.com` â†’ ä»…å‘4æ¬¡åŒ…  |
| `traceroute baidu.com`        | è·¯ç”±è¿½è¸ª (æ’æŸ¥è·¨ç½‘æ®µé—®é¢˜) | `mtr baidu.com` â†’ åŠ¨æ€è·¯ç”±åˆ†æ (éœ€å®‰è£…) |
| `curl -I https://example.com` | **æ£€æŸ¥ HTTP å“åº”å¤´**    | `curl -o /dev/null -s -w '%{http_code}\n' url` â†’ è·å–çŠ¶æ€ç  |
| `tcpdump -i eth0 port 80 -w capture.pcap` | **æŠ“åŒ…åˆ†æ** | `tcpdump host 192.168.1.100` â†’ æŠ“æŒ‡å®š IP æµé‡ |

---

### **äº”ã€ç”¨æˆ· & æƒé™**
| å‘½ä»¤                     | ä½œç”¨                | å®‰å…¨å»ºè®®                      |
|--------------------------|-------------------|-----------------------------|
| `sudo -i`                | åˆ‡æ¢åˆ° root        | é¿å…ç›´æ¥ä½¿ç”¨ root è´¦å·         |
| `chmod 755 filename`     | ä¿®æ”¹æ–‡ä»¶æƒé™       | `chmod -R 644 /dir` â†’ é€’å½’è®¾ç½® |
| `chown user:group file`  | ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…     | `chown -R www-data:www-data /var/www` |
| `useradd -m deploy`      | åˆ›å»ºæ–°ç”¨æˆ·         | `passwd deploy` â†’ è®¾ç½®å¯†ç       |
| `visudo`                 | **å®‰å…¨ç¼–è¾‘ sudoers** | æ·»åŠ  `deploy ALL=(ALL) NOPASSWD: ALL` å…å¯† sudo |

---

### **å…­ã€é«˜çº§æŠ€å·§ (è¿ç»´å¿…å¤‡)**
```bash
# 1. å®æ—¶è¿½è¸ªæ—¥å¿— (æ’æŸ¥é”™è¯¯)
tail -f /var/log/nginx/error.log | grep "404"

# 2. æ‰¹é‡æ›¿æ¢æ–‡æœ¬ (sed)
sed -i 's/old_text/new_text/g' /etc/config.conf

# 3. ç»Ÿè®¡æ—¥å¿—ä¸­çš„ IP è®¿é—®æ¬¡æ•°
awk '{print $1}' access.log | sort | uniq -c | sort -nr | head -10

# 4. å¿«é€Ÿç”Ÿæˆå¤§æ–‡ä»¶ (æµ‹è¯•ç”¨)
dd if=/dev/zero of=testfile bs=1G count=2  # ç”Ÿæˆ 2GB æ–‡ä»¶

# 5. æœåŠ¡å™¨é—´å…å¯†ç™»å½• (è‡ªåŠ¨åŒ–åŸºç¡€)
ssh-keygen -t ed25519  # æœ¬åœ°ç”Ÿæˆå¯†é’¥
ssh-copy-id user@remote-server  # ä¸Šä¼ å…¬é’¥
```

---

### **å…³é”®åŸåˆ™ï¼š**
1. **æƒé™æœ€å°åŒ–**ï¼šæ°¸è¿œä¸è¦ç”¨ root è·‘åº”ç”¨ï¼Œç”¨ `sudo` ä»£æ›¿ã€‚
2. **æ—¥å¿—é©±åŠ¨**ï¼šé—®é¢˜å…ˆæŸ¥æ—¥å¿— (`/var/log/` + `journalctl`)ã€‚
3. **å¤‡ä»½å†æ“ä½œ**ï¼šä¿®æ”¹é…ç½®å‰æ‰§è¡Œ `cp config.conf{,.bak}`ã€‚
4. **ç®¡é“ç»„åˆ**ï¼š`grep`/`awk`/`sed` + ç®¡é“ (`|`) æ˜¯æ–‡æœ¬å¤„ç†æ ¸å¿ƒã€‚
5. **man æ˜¯æœ‹å‹**ï¼šå¿˜è®°å‚æ•°æ—¶ `man command` çœ‹å®˜æ–¹æ–‡æ¡£ã€‚

> ğŸ’¡ **æç¤º**ï¼šç”Ÿäº§ç¯å¢ƒæ“ä½œå‰ï¼Œå…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯å‘½ä»¤ï¼  
> **å±é™©å‘½ä»¤æ…ç”¨**ï¼š`rm -rf /`ã€`:(){ :|:& };:` (forkç‚¸å¼¹)ã€`dd if=/dev/random of=/dev/sda` (ç£ç›˜æ“¦é™¤)

æŒæ¡è¿™äº›å‘½ä»¤ï¼Œä½ å·²å…·å¤‡ **80% çš„æ—¥å¸¸è¿ç»´èƒ½åŠ›**ã€‚æ·±å…¥å­¦ä¹ å»ºè®®ï¼š
- é€šè¿‡ `tldr command` å®‰è£…ç®€åŒ–ç‰ˆ man æ‰‹å†Œ (`apt install tldr`)
- åœ¨ [explainshell.com](https://explainshell.com) è§£æå¤æ‚å‘½ä»¤
- å®è·µã€ŠLinux 101 Hacksã€‹ç”µå­ä¹¦ä¸­çš„åœºæ™¯æ¡ˆä¾‹