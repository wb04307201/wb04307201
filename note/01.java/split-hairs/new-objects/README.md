# `String str = new String("123")`会在堆中生成几个新对象

在Java中执行 `String str = new String("123");` 时，**堆中会生成1个或2个新对象

## 关键机制分析：
1. **字符串常量池（String Pool）**：
    - 字符串字面量 `"123"` 会被存储在字符串常量池中（位于堆内存的元空间区域）。
    - 如果常量池中**已存在** `"123"`，则不会重复创建；如果**不存在**，则会创建一个新对象存入常量池。

2. **`new` 操作的行为**：
    - `new String("123")` 会在堆中创建一个**新的String实例对象**，该对象的内部字符数组引用指向常量池中的 `"123"`。

## 场景拆解：
- **情况1：常量池中无 `"123"`**
    - 常量池中创建 `"123"` 对象（1个对象）。
    - 堆中创建新的String实例对象（1个对象）。  
      **总计：2个新对象**。

- **情况2：常量池中已有 `"123"`**
    - 常量池中不创建新对象。
    - 堆中仅创建新的String实例对象（1个对象）。  
      **总计：1个新对象**。

## 结论：
- **通常情况（首次执行）**：生成 **2个对象**（常量池1个 + 堆中新实例1个）。
- **重复执行时**：若常量池已存在 `"123"`，则仅生成 **1个对象**（堆中新实例）。

## 补充说明：
- 字符串常量池在Java 7后移至堆内，因此常量池中的对象也属于堆内存。
- `new String("123")` 强制在堆中创建新实例，即使内容相同，地址也不同（与直接赋值 `String str = "123"` 不同）。

**示例验证代码**：
```java
String s1 = new String("123"); // 常量池无"123"：创建2个对象
String s2 = new String("123"); // 常量池已有"123"：创建1个对象

System.out.println(s1 == s2); // false（地址不同）
System.out.println(s1.equals(s2)); // true（内容相同）
```